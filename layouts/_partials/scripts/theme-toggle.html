<script>
  function toggleTheme() {
    const html = document.documentElement;
    const isDark = html.classList.contains('dark');
    
    if (isDark) {
      html.classList.remove('dark');
      localStorage.setItem('theme', 'light');
    } else {
      html.classList.add('dark');
      localStorage.setItem('theme', 'dark');
    }
    
    // Update giscus theme if present
    updateGiscusTheme(isDark ? 'light' : 'dark');
  }

  function updateGiscusTheme(theme) {
    const giscusFrame = document.querySelector('iframe[src*="giscus"]');
    if (giscusFrame) {
      giscusFrame.contentWindow.postMessage({
        giscus: { setConfig: { theme: theme } }
      }, 'https://giscus.app');
    }
  }

  // Apply saved theme on load
  document.addEventListener('DOMContentLoaded', function() {
    const savedTheme = localStorage.getItem('theme');
    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    
    if (savedTheme === 'dark' || (!savedTheme && prefersDark)) {
      document.documentElement.classList.add('dark');
    }
    
    // Update giscus theme on load
    setTimeout(() => {
      const currentTheme = document.documentElement.classList.contains('dark') ? 'dark' : 'light';
      updateGiscusTheme(currentTheme);
    }, 1000);
  });
</script>